(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["add"],{7298:function(e,t,a){},"7e55":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("BookInfo",{attrs:{backPage:"/",barTitle:"Add new book"}})},o=[],i=a("cebc"),s=a("2f62"),n=a("cc74"),l={name:"add",components:{BookInfo:n["a"]},methods:Object(i["a"])({},Object(s["b"])("bar",{clearBar:"clearAll"})),beforeRouteLeave:function(e,t,a){this.clearBar(),a()}},u=l,c=a("2877"),d=Object(c["a"])(u,r,o,!1,null,null,null);t["default"]=d.exports},"7f7f":function(e,t,a){var r=a("86cc").f,o=Function.prototype,i=/^\s*function ([^ (]*)/,s="name";s in o||a("9e1e")&&r(o,s,{configurable:!0,get:function(){try{return(""+this).match(i)[1]}catch(e){return""}}})},cc74:function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"info"},[a("form",[e._l(e.fields,function(t,r){return["checkbox"===t.type&&"textarea"!=t.type?a("input",e._g({directives:[{name:"model",rawName:"v-model",value:t.value,expression:"field.value"}],class:{error:e.isError(r)},attrs:{placeholder:t.name,type:"checkbox"},domProps:{checked:Array.isArray(t.value)?e._i(t.value,null)>-1:t.value},on:{change:function(a){var r=t.value,o=a.target,i=!!o.checked;if(Array.isArray(r)){var s=null,n=e._i(r,s);o.checked?n<0&&e.$set(t,"value",r.concat([s])):n>-1&&e.$set(t,"value",r.slice(0,n).concat(r.slice(n+1)))}else e.$set(t,"value",i)}}},t.onFocus?{focus:t.onFocus}:{})):"radio"===t.type&&"textarea"!=t.type?a("input",e._g({directives:[{name:"model",rawName:"v-model",value:t.value,expression:"field.value"}],class:{error:e.isError(r)},attrs:{placeholder:t.name,type:"radio"},domProps:{checked:e._q(t.value,null)},on:{change:function(a){return e.$set(t,"value",null)}}},t.onFocus?{focus:t.onFocus}:{})):"textarea"!=t.type?a("input",e._g({directives:[{name:"model",rawName:"v-model",value:t.value,expression:"field.value"}],class:{error:e.isError(r)},attrs:{placeholder:t.name,type:t.type},domProps:{value:t.value},on:{input:function(a){a.target.composing||e.$set(t,"value",a.target.value)}}},t.onFocus?{focus:t.onFocus}:{})):a("textarea",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"field.value"}],class:{error:e.isError(r)},attrs:{placeholder:t.name},domProps:{value:t.value},on:{input:function(a){a.target.composing||e.$set(t,"value",a.target.value)}}})]}),e.is.edit()?a("button",{staticClass:"delete",on:{click:function(t){return t.preventDefault(),e.deleteThis(t)}}},[e._v("Delete")]):e._e()],2),e.isLoading?a("Loading"):e._e(),a("div",{staticClass:"errors"},[e.errors.length?a("p",[e._v("Error!")]):e._e(),a("transition-group",{attrs:{name:"list",tag:"ul"}},e._l(e.errors,function(t,r){return a("li",{key:t.field,style:"--delay: ."+1*r+"s"},[e._v(e._s(t.msg))])}),0)],1)],1)},o=[],i=(a("4917"),a("7f7f"),a("ac6a"),a("a4bb")),s=a.n(i),n=(a("7514"),a("cebc")),l=(a("28a5"),a("2f62")),u=a("3a5e"),c={name:"BookInfo",props:{backPage:String,barTitle:String,book:Object},components:{Loading:u["a"]},data:function(){return{fields:{title:{type:"text",name:"Title",value:"",required:!0},author:{type:"text",name:"Author",value:"",required:!0},date:{type:"text",name:"Created at",value:"",required:!0,pattern:/^([12]\d{3})-(0[1-9]|1[0-2])-(0[1-9]|[12]\d|3[01])$/,onFocus:function(e){e.target.type="date"}},desc:{type:"textarea",name:"Description",value:"",required:!0}},errors:[],booooks:[]}},mounted:function(){this.setBar({pos:"left",text:"Back",path:this.backPage}),this.setBar({pos:"center",text:this.barTitle}),this.setBar({pos:"right",text:"Save",func:this.submit}),this.is.edit()&&this.book&&(this.fields.title.value=this.book.attributes.title,this.fields.author.value=this.book.attributes.author,this.fields.date.value=this.book.attributes.publicationDate.split("T")[0],this.fields.desc.value=this.book.attributes.description)},methods:Object(n["a"])({isError:function(e){var t=this.errors.find(function(t){return t.field==e});return void 0!==t},submit:function(){var e=this;this.errors=[],this.$nextTick(function(){if(e.validate()){e.disableBar({pos:"right"});var t=e.is.add()?"addBook":"updateBook",a={title:e.fields.title.value,desc:e.fields.desc.value,author:e.fields.author.value,date:e.fields.date.value};e.is.edit()&&(a["id"]=e.$route.params.id),e[t](a).then(function(t){e.clearBooks();var a=e.getRealId(t.id);e.$router.push("/book/"+a)})}})},validate:function(){var e=this,t=s()(this.fields);return t.forEach(function(a,r){var o=e.fields[a];!o.required||o.value?!o.pattern||o.pattern.test(o.value)||e.errors.push({field:t[r],msg:'"'.concat(o.name,'" field has wrong value.')}):e.errors.push({field:t[r],msg:'"'.concat(o.name,'" field is required.')})}),0==this.errors.length},deleteThis:function(){var e=this;this.deleteBook({id:this.$route.params.id}).then(function(t){e.clearBooks(),e.$router.push("/")})},getRealId:function(e){return e.match(/books\/([a-z0-9-]+)/)[1]}},Object(l["b"])("books",["addBook","updateBook","deleteBook"]),Object(l["c"])("books",["clearBooks","clearBook"]),Object(l["b"])("bar",{setBar:"set",clearBar:"clearAll",disableBar:"disable"})),computed:Object(n["a"])({is:function(){var e=this;return{add:function(){return"add"==e.$route.name},edit:function(){return"edit"==e.$route.name}}}},Object(l["d"])("books",["isLoading"]))},d=c,f=(a("dde2"),a("2877")),v=Object(f["a"])(d,r,o,!1,null,"6e480236",null);t["a"]=v.exports},dde2:function(e,t,a){"use strict";var r=a("7298"),o=a.n(r);o.a}}]);
//# sourceMappingURL=add.2e3fc3ee.js.map